---
const currentPath = Astro.url.pathname;
---

<header class="bg-white shadow-sm sticky top-0 z-40 transition-all duration-300" id="header">
  <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between items-center h-16">
      <!-- Logo -->
      <div class="flex-shrink-0">
        <a href="/" class="flex items-center space-x-2">
          <img class="h-10 w-auto" src="/images/logo.png" alt="Serasi Parket" />
          <span class="font-display font-bold text-xl text-primary-800">Serasi Parket</span>
        </a>
      </div>

      <!-- Desktop Navigation -->
      <div class="hidden md:block">
        <div class="ml-10 flex items-baseline space-x-8">
          <a 
            href="/" 
            class={`px-3 py-2 text-sm font-medium transition-colors duration-300 ${
              currentPath === '/' 
                ? 'text-primary-600 border-b-2 border-primary-600' 
                : 'text-gray-700 hover:text-primary-600'
            }`}
          >
            Beranda
          </a>
          <div class="relative group">
            <button class="flex items-center px-3 py-2 text-sm font-medium text-gray-700 hover:text-primary-600 transition-colors duration-300">
              Produk
              <svg class="ml-1 h-4 w-4 transition-transform duration-300 group-hover:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
              </svg>
            </button>
            <div class="absolute left-0 mt-2 w-64 bg-white rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 z-50">
              <div class="py-2">
                <a href="/products" class="block px-4 py-2 text-sm text-gray-700 hover:bg-primary-50 hover:text-primary-600">Semua Produk</a>
                <a href="/products/kayu-jati" class="block px-4 py-2 text-sm text-gray-700 hover:bg-primary-50 hover:text-primary-600">Kayu Jati</a>
                <a href="/products/kayu-ulin" class="block px-4 py-2 text-sm text-gray-700 hover:bg-primary-50 hover:text-primary-600">Kayu Ulin</a>
                <a href="/products/kayu-merbau" class="block px-4 py-2 text-sm text-gray-700 hover:bg-primary-50 hover:text-primary-600">Kayu Merbau</a>
                <a href="/products/kayu-meranti" class="block px-4 py-2 text-sm text-gray-700 hover:bg-primary-50 hover:text-primary-600">Kayu Meranti</a>
              </div>
            </div>
          </div>
          <div class="relative group">
            <button class="flex items-center px-3 py-2 text-sm font-medium text-gray-700 hover:text-primary-600 transition-colors duration-300">
              Aplikasi
              <svg class="ml-1 h-4 w-4 transition-transform duration-300 group-hover:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
              </svg>
            </button>
            <div class="absolute left-0 mt-2 w-48 bg-white rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 z-50">
              <div class="py-2">
                <a href="/applications" class="block px-4 py-2 text-sm text-gray-700 hover:bg-primary-50 hover:text-primary-600">Portfolio</a>
                <a href="/applications/flooring" class="block px-4 py-2 text-sm text-gray-700 hover:bg-primary-50 hover:text-primary-600">Flooring</a>
                <a href="/applications/dinding" class="block px-4 py-2 text-sm text-gray-700 hover:bg-primary-50 hover:text-primary-600">Dinding</a>
                <a href="/applications/deck" class="block px-4 py-2 text-sm text-gray-700 hover:bg-primary-50 hover:text-primary-600">Deck</a>
              </div>
            </div>
          </div>
          <a 
            href="/about" 
            class={`px-3 py-2 text-sm font-medium transition-colors duration-300 ${
              currentPath === '/about' 
                ? 'text-primary-600 border-b-2 border-primary-600' 
                : 'text-gray-700 hover:text-primary-600'
            }`}
          >
            Tentang
          </a>
          <a 
            href="/blog" 
            class={`px-3 py-2 text-sm font-medium transition-colors duration-300 ${
              currentPath.startsWith('/blog') 
                ? 'text-primary-600 border-b-2 border-primary-600' 
                : 'text-gray-700 hover:text-primary-600'
            }`}
          >
            Blog
          </a>
          <a 
            href="/contact" 
            class={`px-3 py-2 text-sm font-medium transition-colors duration-300 ${
              currentPath === '/contact' 
                ? 'text-primary-600 border-b-2 border-primary-600' 
                : 'text-gray-700 hover:text-primary-600'
            }`}
          >
            Kontak
          </a>
        </div>
      </div>

      <!-- CTA Button -->
      <div class="hidden md:block">
        <a 
          href="/contact" 
          class="bg-primary-600 text-white px-6 py-2 rounded-lg font-medium hover:bg-primary-700 transition-all duration-300 hover:shadow-lg"
          onclick="gtag('event', 'click', { 'event_category': 'CTA', 'event_label': 'Header Consultation' });"
        >
          Konsultasi Gratis
        </a>
      </div>

      <!-- Mobile menu button -->
      <div class="md:hidden">
        <button id="mobile-menu-button" class="text-gray-700 hover:text-primary-600 focus:outline-none">
          <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </button>
      </div>
    </div>

    <!-- Mobile Navigation Menu -->
    <div id="mobile-menu" class="md:hidden hidden">
      <div class="px-2 pt-2 pb-3 space-y-1 bg-white border-t border-gray-200">
        <a href="/" class="block px-3 py-2 text-base font-medium text-gray-700 hover:text-primary-600 hover:bg-primary-50 rounded-md">Beranda</a>
        <a href="/products" class="block px-3 py-2 text-base font-medium text-gray-700 hover:text-primary-600 hover:bg-primary-50 rounded-md">Produk</a>
        <a href="/applications" class="block px-3 py-2 text-base font-medium text-gray-700 hover:text-primary-600 hover:bg-primary-50 rounded-md">Aplikasi</a>
        <a href="/about" class="block px-3 py-2 text-base font-medium text-gray-700 hover:text-primary-600 hover:bg-primary-50 rounded-md">Tentang</a>
        <a href="/blog" class="block px-3 py-2 text-base font-medium text-gray-700 hover:text-primary-600 hover:bg-primary-50 rounded-md">Blog</a>
        <a href="/contact" class="block px-3 py-2 text-base font-medium text-gray-700 hover:text-primary-600 hover:bg-primary-50 rounded-md">Kontak</a>
        <a href="/contact" class="block mx-3 mt-4 bg-primary-600 text-white px-4 py-2 rounded-lg font-medium text-center hover:bg-primary-700 transition-colors duration-300">
          Konsultasi Gratis
        </a>
      </div>
    </div>
  </nav>
</header>

<script>
  // Mobile menu toggle
  const mobileMenuButton = document.getElementById('mobile-menu-button');
  const mobileMenu = document.getElementById('mobile-menu');

  if (mobileMenuButton && mobileMenu) {
    mobileMenuButton.addEventListener('click', () => {
      mobileMenu.classList.toggle('hidden');
    });
  }

  // Header scroll effect
  let lastScrollTop = 0;
  const header = document.getElementById('header');
  
  window.addEventListener('scroll', () => {
    let scrollTop = window.pageYOffset || document.documentElement.scrollTop;
    
    if (scrollTop > lastScrollTop && scrollTop > 100) {
      // Scrolling down
      header.style.transform = 'translateY(-100%)';
    } else {
      // Scrolling up
      header.style.transform = 'translateY(0)';
    }
    
    // Add background when scrolled
    if (scrollTop > 50) {
      header.classList.add('bg-white/95', 'backdrop-blur-sm');
    } else {
      header.classList.remove('bg-white/95', 'backdrop-blur-sm');
    }
    
    lastScrollTop = scrollTop;
  });
</script>
